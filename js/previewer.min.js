!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(_){_.fn.nd_drags=function(s){return(""===(s=_.extend({handle:"",cursor:"move"},s)).handle?this:this.find(s.handle)).css("cursor",s.cursor).on("mousedown",function(e){var t="",n=(t=""===s.handle?_(this).addClass("draggable"):_(this).addClass("active-handle").parent().addClass("draggable")).css("z-index"),d=t.outerHeight(),a=t.outerWidth(),i=t.offset().top+d-e.pageY,o=t.offset().left+a-e.pageX;t.css("z-index",1e3).parents().on("mousemove",function(e){_(".draggable").offset({top:e.pageY+i-d,left:e.pageX+o-a}).on("mouseup",function(){_(this).removeClass("draggable").css("z-index",n)})}),e.preventDefault()}).on("mouseup",function(){""===s.handle?_(this).removeClass("draggable"):_(this).removeClass("active-handle").parent().removeClass("draggable")})},_.fn.previewer=function(e){function t(){return!!("ontouchstart"in window)}var s=this,d=t()?"touchstart":"click",n=t()?"touchstart":"mousedown",a=t()?"touchend touchcancel":"mouseup mouseleave",i=0,o="",r=[],l="",c="",u=_.extend({},{hold_time:1,show_tab:!0,direction:"ltr",sandbox:{active:!0,types:"allow-same-origin allow-scripts"},show_scroll:!1,responsive:!0,style:{width:"60%",height:"300px",radius:" 0 0 0 6px"},class:"",focus:!0,dragable:!1},e),f={$root:"",$body:function(){return this.$root.find(".nd_body")},$head:function(){return this.$root.find(".nd_head")},_show:function(e){this.$root.fadeIn(e)},_hide:function(e){this.$root.fadeOut(e)}};s.find("a").on("touchstart click",function(e){e.preventDefault()}),s.find("a").on(n,function(e){e.preventDefault();var t=_(this);i=setTimeout(function(){l=t.attr("href"),o=t.attr("title")||t.text(),c="nd_"+Math.random().toString(36).substr(2,9),-1==jQuery.inArray(o,r)?(r.push(o),t.attr("data-id",c),h(),v(l)):(f._show(),f.$root.find('.nd_head [data-id="'+_(t).data("id")+'"]').trigger("click"))},u.hold_time)}).on(a,function(e){e.preventDefault(),clearTimeout(i)});var h=function(e){0==f.$root.length&&_("body").append('<div dir="'+u.direction+'" class="modal_previewer '+u.class+" previewer_"+u.direction+' " style="width:'+u.style.width+";height:"+u.style.height+'"> <div class="nd_head"> <div class="btn_prevSlide"></div> <div class="btn_nextSlide"></div> <div class="btn_close"></div> <ul></ul></div> <div class="nd_body"></div> <div class="nd_footer"></div> </div>'),f.$root=_("body .modal_previewer"),f.$head().find("ul").append('<li data-id="'+c+'"><span>'+o+'</span> <b class="btn_closeTabe"></b> </li>'),u.show_tab||f.$head().addClass("hide"),p()},v=function(e){f.$body().find("> div").hide();var t="";u.sandbox.active&&(t='sandbox="'+u.sandbox.types+'"'),f.$body().append('<div id="'+c+'"> <iframe src="'+e+'" '+t+"></iframe> </div>").find("#"+c).fadeIn(),f._show(),b()},p=function(){var n=0;_(".modal_previewer ul li").each(function(e,t){n+=_(t).innerWidth()+70}),f.$head().innerWidth()<=n?(_(".btn_prevSlide,.btn_nextSlide").fadeIn(),_(".btn_close").addClass("active")):(_(".btn_prevSlide,.btn_nextSlide").fadeOut(),_(".btn_close").removeClass("active"))},b=function(){var t="rtl"==u.direction?"left":"right",e="rtl"==u.direction?".btn_prevSlide":".btn_nextSlide",n="rtl"==u.direction?".btn_nextSlide":".btn_prevSlide";_(".modal_previewer .nd_head  .btn_close").on(d,function(){f._hide(function(){s.removeClass("modal_blur")})}),_(e).on(d,function(){var e=parseInt(f.$head().find("ul").css(t));0<e?e-60<0?f.$head().find("ul").css(t,"0"):f.$head().find("ul").css(t,e-60+"px"):f.$head().find("ul").css(t,"0")}),_(n).on(d,function(){var e=parseInt(f.$head().find("ul").css(t));f.$head().find("ul").css(t,e+60+"px")}),_(document).on(d,".modal_previewer .nd_head ul li",function(e){if(_(e.target).hasClass("btn_closeTabe")){var t=_(e.target).parent().data("id"),n=_(e.target).parent().find("span").text(),d=r.indexOf(n);if(-1!==d&&r.splice(d,1),0==r.length&&(s.removeClass("modal_blur"),f._hide("fast")),0===_(this).prev().text().length){var a=_(e.target).parent().next().data("id");f.$body().find("#"+a).fadeIn()}else{var i=_(e.target).parent().prev().data("id");f.$body().find("#"+i).fadeIn()}f.$body().find("#"+t).remove(),_(e.target).parent().remove(),p()}else{var o=_(this).data("id");f.$head().find("ul li").removeClass("active"),_(this).addClass("active"),f.$body().find("> div").hide(),f.$body().find("> div#"+o).show()}}),u.dragable&&f.$root.nd_drags(),u.focus&&f.$root.mouseleave(function(){s.removeClass("modal_blur")}).mouseenter(function(){s.addClass("modal_blur")})}}});